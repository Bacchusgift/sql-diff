#!/bin/bash

# Mock AI åŠŸèƒ½æ¼”ç¤ºè„šæœ¬ï¼ˆæ— éœ€çœŸå®ž API Keyï¼‰

echo "======================================"
echo "SQL-Diff Mock AI åŠŸèƒ½æ¼”ç¤º"
echo "======================================"
echo ""
echo "æ³¨æ„ï¼šæ­¤æ¼”ç¤ºä½¿ç”¨æ¨¡æ‹Ÿçš„ AI å“åº”ï¼Œæ— éœ€çœŸå®ž API Key"
echo ""

# åˆ›å»ºä¸´æ—¶é…ç½®æ–‡ä»¶ï¼ˆä½¿ç”¨mockæä¾›å•†ï¼‰
cat > /tmp/sql-diff-mock-config.yaml << 'EOF'
ai:
  enabled: true
  provider: mock
  api_key: mock-api-key
  api_endpoint: http://mock.api
  model: mock-model
  timeout: 30
EOF

echo "âœ“ åˆ›å»ºæ¨¡æ‹Ÿé…ç½®æ–‡ä»¶"
echo ""

# ç”±äºŽå½“å‰å®žçŽ°ä¸ç›´æŽ¥æ”¯æŒmock providerï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç¤ºä¾‹è¾“å‡º
echo "ç¤ºä¾‹ AI åˆ†æžè¾“å‡ºï¼š"
echo "--------------------------------------"
echo ""
echo "ðŸ“Š å·®å¼‚åˆ†æž:"
echo "æ£€æµ‹åˆ°è¡¨ç»“æž„å˜æ›´ï¼Œä¸»è¦æ–°å¢žäº† email å’Œ created_at ä¸¤ä¸ªå­—æ®µã€‚"
echo "è¿™äº›å˜æ›´ç¬¦åˆå¸¸è§çš„ç”¨æˆ·è¡¨è®¾è®¡æ¨¡å¼ã€‚"
echo ""
echo "âœ¨ ä¼˜åŒ–å»ºè®®:"
echo "  1. å»ºè®®ä¸º email å­—æ®µæ·»åŠ å”¯ä¸€ç´¢å¼•ä»¥ç¡®ä¿é‚®ç®±å”¯ä¸€æ€§"
echo "  2. å»ºè®®ä¸º NOT NULL å­—æ®µè®¾ç½®åˆç†çš„é»˜è®¤å€¼"
echo "  3. è€ƒè™‘æ·»åŠ  updated_at å­—æ®µè®°å½•æ›´æ–°æ—¶é—´"
echo ""
echo "âš ï¸  æ½œåœ¨é£Žé™©:"
echo "  1. å¦‚æžœè¡¨ä¸­å·²æœ‰æ•°æ®ï¼Œæ–°å¢ž NOT NULL å­—æ®µéœ€è¦æä¾›é»˜è®¤å€¼æˆ–è¿ç§»æ•°æ®"
echo "  2. å¤§è¡¨æ·»åŠ å­—æ®µå¯èƒ½å¯¼è‡´é•¿æ—¶é—´é”è¡¨ï¼Œå½±å“çº¿ä¸Šä¸šåŠ¡"
echo ""
echo "ðŸ“– æœ€ä½³å®žè·µ:"
echo "  1. ä½¿ç”¨ pt-online-schema-change ç­‰å·¥å…·è¿›è¡Œåœ¨çº¿ DDL å˜æ›´"
echo "  2. åœ¨æµ‹è¯•çŽ¯å¢ƒå……åˆ†éªŒè¯åŽå†åº”ç”¨åˆ°ç”Ÿäº§çŽ¯å¢ƒ"
echo "  3. å»ºè®®åœ¨ä¸šåŠ¡ä½Žå³°æœŸæ‰§è¡Œè¡¨ç»“æž„å˜æ›´"
echo "  4. ä¿ç•™è¡¨ç»“æž„å˜æ›´çš„å›žæ»šæ–¹æ¡ˆ"
echo ""
echo "--------------------------------------"
echo ""

# å®žé™…æµ‹è¯•ï¼ˆä¸ä½¿ç”¨AIï¼‰
echo "å®žé™…æ¯”å¯¹ç¤ºä¾‹ï¼ˆä¸å¯ç”¨AIï¼‰:"
echo "--------------------------------------"
./bin/sql-diff \
  -s "CREATE TABLE users (id INT PRIMARY KEY, name VARCHAR(100))" \
  -t "CREATE TABLE users (id INT PRIMARY KEY, name VARCHAR(100), email VARCHAR(255) NOT NULL, created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP)"

echo ""
echo ""
echo "ðŸ’¡ æç¤ºï¼š"
echo "- ä¸Šé¢å±•ç¤ºçš„ AI åˆ†æžæ˜¯æ¨¡æ‹Ÿè¾“å‡º"
echo "- è¦ä½¿ç”¨çœŸå®žçš„ AI åˆ†æžï¼Œè¯·é…ç½®æœ‰æ•ˆçš„ DeepSeek API Key"
echo "- è¿è¡Œ ./examples/test-ai.sh è¿›è¡ŒçœŸå®ž AI æµ‹è¯•"
echo ""

# æ¸…ç†
rm -f /tmp/sql-diff-mock-config.yaml
echo "======================================"
echo "æ¼”ç¤ºå®Œæˆï¼"
echo "======================================"
